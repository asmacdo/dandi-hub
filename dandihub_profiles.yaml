- display_name: "Tiny. Useful for many quick things"
  description: "0.5 CPU / 1 GB"
  profile_options:
    image:
      display_name: "Image"
      choices:
        standard:
          display_name: "Standard"
          default: true
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}"
  kubespawner_override:
    image_pull_policy: Always
    cpu_limit: 2
    cpu_guarantee: 0.25
    mem_limit: 2G
    mem_guarantee: 0.5G
    node_selector:
      NodePool: default
- display_name: "Base"
  description: "6 CPU / 16 GB up to 12C/32G. May take up to 15 mins to start."
  profile_options:
    image:
      display_name: "Image"
      choices:
        standard:
          display_name: "Standard"
          default: true
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}"
        matlab:
          display_name: "MATLAB (must provide your own license)"
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}-matlab"
  default: true
  kubespawner_override:
    image_pull_policy: Always
    cpu_limit: 12
    cpu_guarantee: 6
    mem_limit: 32G
    mem_guarantee: 16G
    node_selector:
      NodePool: default
- display_name: "Medium"
  description: "12C/32G up to 24C/64G. May take up to 15 mins to start."
  profile_options:
    image:
      display_name: "Image"
      choices:
        standard:
          display_name: "Standard"
          default: true
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}"
        matlab:
          display_name: "MATLAB (must provide your own license)"
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}-matlab"
  kubespawner_override:
    image_pull_policy: Always
    cpu_limit: 24
    cpu_guarantee: 12
    mem_limit: 64G
    mem_guarantee: 32G
    node_selector:
      NodePool: default
- display_name: "Large"
  description: "24C/64G up to 48C/96G. May take up to 15 mins to start."
  profile_options:
    image:
      display_name: "Image"
      choices:
        standard:
          display_name: "Standard"
          default: true
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}"
        matlab:
          display_name: "MATLAB (must provide your own license)"
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}-matlab"
  kubespawner_override:
    image_pull_policy: Always
    cpu_limit: 48
    cpu_guarantee: 24
    mem_limit: 96G
    mem_guarantee: 64G
    node_selector:
      NodePool: default
- display_name: "T4 GPU for inference"
  description: "8 CPU / 30 GB / 1 T4 GPU. May take up to 15 mins to start."
  profile_options:
    image:
      display_name: "Image"
      choices:
        standard:
          display_name: "Standard GPU"
          default: true
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}-gpu"
        matlab:
          display_name: "MATLAB GPU (must provide your own license)"
          kubespawner_override:
            image: "${singleuser_image_repo}:${singleuser_image_tag}-gpu-matlab"
  kubespawner_override:
    image_pull_policy: Always
    cpu_limit: 8
    cpu_guarantee: 6
    mem_limit: 31G
    mem_guarantee: 25G
    extra_resource_limits:
      nvidia.com/gpu: "1"
    node_selector:
      NodePool: gpu
      node.kubernetes.io/instance-type: g4dn.2xlarge
    tolerations:
      - key: "nvidia.com/gpu"
        operator: "Exists"
        effect: "NoSchedule"
      - key: "hub.jupyter.org/dedicated" # According to optimization docs https://z2jh.jupyter.org/en/latest/administrator/optimization.html
        operator: "Equal"
        value: "user"
        effect: "NoSchedule"
